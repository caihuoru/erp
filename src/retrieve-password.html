<!DOCTYPE html>
<html lang="en">
	<head>
		<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
		<meta charset="utf-8" />
		<title>找回密码</title>

		<meta name="description" content="Common form elements and layouts" />
		<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0" />

		<!-- bootstrap & fontawesome -->
		<link rel="stylesheet" type="text/css" href="../assets/css/bootstrap.min.css"/>
		<link rel="stylesheet" type="text/css" href="../assets/font-awesome/css/font-awesome.min.css"/>

		<!-- page specific plugin styles -->
		<link rel="stylesheet" href="../assets/css/jquery-ui.custom.min.css" />
		<link rel="stylesheet" href="../assets/css/chosen.min.css" />
		<link rel="stylesheet" href="../assets/css/bootstrap-datepicker3.min.css" />
		<link rel="stylesheet" href="../assets/css/bootstrap-timepicker.min.css" />
		<link rel="stylesheet" href="../assets/css/daterangepicker.min.css" />
		<link rel="stylesheet" href="../assets/css/bootstrap-datetimepicker.min.css" />
		<link rel="stylesheet" href="../assets/css/bootstrap-colorpicker.min.css" />

		

        <!-- ace styles -->
        <link rel="stylesheet" href="../assets/css/sensir.css"/>
		<link rel="stylesheet" href="../assets/css/erp.min.css" class="ace-main-stylesheet" id="main-ace-style" />

		<!--[if lte IE 9]>
			<link rel="stylesheet" href="../assets/css/erp-part2.min.css" class="ace-main-stylesheet" />
		<![endif]-->
		<link rel="stylesheet" href="../assets/css/erp-skins.min.css" />
		<link rel="stylesheet" href="../assets/css/erp-rtl.min.css" />

		<!--[if lte IE 9]>
		  <link rel="stylesheet" href="../assets/css/erp-ie.min.css" />
		<![endif]-->

		<!-- inline styles related to this page -->

		<!-- ace settings handler -->
		<script src="../assets/js/erp-extra.min.js"></script>

		<!-- HTML5shiv and Respond.js for IE8 to support HTML5 elements and media queries -->

		<!--[if lte IE 8]>
		<script src="../assets/js/html5shiv.min.js"></script>
		<script src="../assets/js/respond.min.js"></script>
		<![endif]-->
    </head>
<body class="retrieve-main">
        <div class="row retrieve-head">
                <div class="col-sm-12">
                    <div class="login-page-header">
                        <h1 class="row">
                            <span class="col-sm-5 col-sm-offset-1">
                                <i class="ace-icon fa fa-erp-logo"></i>
                                <span class="black" id="id-text2">装企ERP管理系统登录平台</span>
                            </span><!-- /.col -->
                            <span class="col-sm-5 get_user">
                                <label class="pull-right inline" onclick="ApplyForUse()">
                                    <a class="red-border-side">返回首页</a>
                                </label>
                            </span><!-- /.col -->
                        </h1>
                    </div>
                </div>
            </div>
        <div class="step">
            <div class="schedule">
                <div class="step-1">
                    <div class="num now_step">
                        1
                    </div>
                    <div class="step-tip">输入账号</div>
                </div>
                <ul class="step-dot">
                    <li></li>
                    <li></li>
                    <li></li>
                    <li></li>
                    <li></li>
                    <li></li>
                </ul>
                <div class="step-2">
                    <div class="num">
                        2
                    </div>
                    <div class="step-tip">手机验证</div>
                </div>
                <ul class="step-dot">
                    <li></li>
                    <li></li>
                    <li></li>
                    <li></li>
                    <li></li>
                    <li></li>
                </ul>
                <div class="step-3">
                    <div class="num">
                        3
                    </div>
                    <div class="step-tip">输入新密码</div>
                </div>
                <ul class="step-dot">
                    <li></li>
                    <li></li>
                    <li></li>
                    <li></li>
                    <li></li>
                    <li></li>
                </ul>
                <div class="step-4">
                    <div class="num">
                        4
                    </div>
                    <div class="step-tip">完成</div>
                </div>
            </div>
        </div>
        <div class="retrieve">
            <!-- 第一步 -->
            <div class="part-0 retrieve-part">
                <label class="block margin-top-25 clearfix">
                    <span class="input-group">
                        <span class="num">账&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;号：</span> 
                        <input type="text" class="form-control input-height" placeholder="请输入您的注册账号" id="account">
                    </span>
                </label>
                
            </div>
            
            <!-- 第二步 -->
            <div class="part-1 retrieve-part" style="display:none;">
                <label class="block margin-top-25 clearfix">
                    <span class="input-group">
                        <span class="num">手机号：</span> 
                        <input type="text" class="form-control input-height" placeholder="手机号" id="phone">
                    </span>
                </label>
                <label class="block margin-top-25 clearfix">
                    <span class="input-group">
                        <span class="num">验证:</span> 
                        <input type="text" class="form-control input-height" placeholder="短信验证码" id="short">
                        <input type="button" value="获取验证码(60s)" id="btn_sms"> 
                    </span>
                </label>
           </div> 
           <!-- 第三步 -->
           <div class="part-2 retrieve-part" style="display:none;">
                <label class="block margin-top-25 clearfix">
                    <span class="input-group">
                        <span class="num">新密码</span> 
                        <input type="password" class="form-control input-height" placeholder="输入密码" id="password-1">
                    </span>
                </label>
                <label class="block margin-top-25 clearfix">
                    <span class="input-group">
                        <span class="num">确认密码:</span> 
                        <input type="password" class="form-control input-height" placeholder="确认密码" id="password-2">
                    </span>
                </label>
           </div> 


           <!-- 第四步 -->
           <div class="part-3 retrieve-part" style="display:none;">

                <div class="edit-success-ico"></div>
                <div class="complete">修改完成</div>
            </div>
            <div class="verification">
                <input type="button" value="下一步" id="next">
            </div>
        </div>
    
<script src="../assets/js/jquery-2.1.4.min.js"></script>
<script src="../assets/js/layer/layer.js"></script>
<script>
    // 获取短信验证码
    var cleartime
    $("#btn_sms").click(function(){
        if(verification_phone()=="error"){
            return false;
        }
        var index=60;
        $(this).css({"border": "1px solid #D5D5D5"})
        $(this).attr({"disabled":"false"});
            cleartime=setInterval(function(){
            index--;
            $("#btn_sms").val(index);
            if(index<=0){
                clearInterval(cleartime);
                $("#btn_sms").val("重新发送");
                $("#btn_sms").removeAttr("disabled");
                return false;
            }
        },1000)
    })

    // 进入下一步
    var step=1;
    $("#next").click(function(){
        //进入第二步
        if(step==1){
            // 账号判断
        if(!$("#account").val()){
                layer.msg("账号不能为空!", {
                    	icon: 2
                });
                return "error";
            }else if($("#account").val()!="mikkle"){
                layer.msg("账号不存在!", {
                    	icon: 2
                });
                return "error";
            }
        
        $(".retrieve-part").hide(300);
        $(".part-1").show(300);
        $(".step-dot").eq(0).find("li").addClass("now_step");
        $(".step-2 .num").addClass("now_step");
        step++;
        }
        // 进入第三步
        else if(step==2){
            if(verification_phone()=="error" || verification_short()=="error"){
                return false;
            }
            $(".retrieve-part").hide(300);
            $(".part-2").show(300);
            $(".step-dot").eq(1).find("li").addClass("now_step");
            $(".step-3 .num").addClass("now_step");
            step++;
        }

        // 进入第四步
        else if(step==3){
            clearInterval(cleartime);
            if(!$("#password-1").val() || !$("#password-2").val()){
                layer.msg("密码不能为空", {
                        icon: 2
                });
                return false;
            }else if(!($("#password-1").val()==$("#password-2").val())){
                layer.msg("两次密码不一致!", {
                        icon: 2
                });
                return false;
            }else{
                // 密码修改完成
                layer.msg("密码修改成功!", {
                        icon: 1
                });
            
            }
            $(".retrieve-part").hide(300);
            $(".part-3").show(300);
            $(".step-dot").eq(2).find("li").addClass("now_step");
            $(".step-4 .num").addClass("now_step");
            $("#next").val("返回登录（3）");
            var index=3;
            setInterval(function(){
                index--;
                $("#next").val("返回登录（"+index+"）");
                if(index<0){
                    // 返回登录
                    window.location.href="/src/login.html";
                }
            },1000);
            step++;
        
        }

        // 第四步
        else if(step>=4){
            //直接返回登录
            layer.msg("回到登录页!", {
                        icon: 1
            });
            window.location.href="/src/login.html";
            

        }else{
            layer.msg("未知错误!", {
                        icon: 2
                });
        }

        
        
    })

    // 手机号判断
    function verification_phone(){
        
        $("#phone").css({"border-color":""});
        var phone = document.getElementById('phone').value;
            if(!(/^1[34578]\d{9}$/.test(phone))){ 
                layer.msg("手机号码有误!", {
                    	icon: 2
                });
                $("#phone").css({"border-color":"red"});
                $(".glyphicon-earphone").css({"border-color":"red"});
               
                return "error"; 
            }

           
    }
    // 验证码判断
    function verification_short(){
        if(!$("#short").val()){
                layer.msg("验证码不能为空!", {
                    	icon: 2
                });
                $("#short").css({"border-color":"red"});
                return "error";
            }else if($("#short").val()!="abc"){
                layer.msg("验证码错误!", {
                    	icon: 2
                });
                $("#short").css({"border-color":"red"});
                return "error";
            }
    }
    
    
</script>
</body>
</html>